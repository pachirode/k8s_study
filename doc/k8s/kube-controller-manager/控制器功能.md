`k8s` 使用 `RBAC` 的授权模式进行资源鉴权，通过角色将角色绑定到指定的主体列表中 `subjects`
角色

- 命名空间级别角色
- 集群级别角色

# clusterrole-aggregation

用来对集群级别的角色进行角色聚合，将一系列通过 `label selector`
选定的集群角色聚合到当前角色中，形成一个复合的 `ClusterRole`

### 监视对象

监视带有 `aggregationRule` 的 `ClusterRole` 对象集合
`aggregationRule` 为控制器定义一个标签选择符，用来匹配应该组合到当前 `ClusterRole` 对象的 `roles` 字段中的 `ClusterRole`
控制器会以覆盖的形式，更新 `roles` 字段中的 `ClusterRole` 对象
如果创建一个与某个已存在的聚合 `ClusterRole` 标签选择符匹配的 `ClusterRole`
，会触发匹配规则，将这个对象添加到聚合 `ClusterRole`

[第一次创建 ClusterRole 对象](./clusterRole-example.yaml)
[第二次创建 ClusterRole 将会被自动添加](./clusterRole-new.yaml)

### 控制器工作原理

- 创建并启动一个 `Shared Informer`
    - 负责 `List-Watch` `apiserver`，获取指定元素的变更事件，将事件保存在一个限速队列中
- 启动一个协程 `runWorker`
    - 不断的从限速队列中获取事件 `key`，调用 `syncHandler` 方法
- `syncHandler`
    - 根据 `key` 从 `Infromer` 的 `Indexer` 中获取完整的资源对象，并根据资源对象的 `Spec` 执行业务逻辑，完成调谐


