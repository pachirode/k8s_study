# DaemonSet

确保集群中的每个特定的节点上运行一个 `Pod` 副本
有新的节点加入，会自动创建 `Pod`

### 使用场景

需要在每个节点上运行系统级服务的场景

- 存储服务
- 日志监控
- 代理
- 网络组件

### 模板

- 必须指定适当的标签以便标签选择器使用
    - 标签选择器必须能够匹配，否则 `API` 拒绝创建
- `restartPolicy` 必须默认

### 节点选择

如果不设置，默认在所有节点创建 `Pod`

- `nodeSelector`
    - 基于节点标签选择
- `nodeAffinity`
    - 更灵活的节点亲和性规则
- `tolerations`

### 调度

- 预定调度，绕过调度器
    - `Pod` 调度之前以及指定目标节点
- 容忍不可调度
- 可以在调度器启动前创建 `Pod`

### 通信

- `Push` 模式
    - `Pod` 主动向外部服务推送数据
- `NodeIP` + 固定端口
- `DNS` 发现
- `Service` 负载均衡

